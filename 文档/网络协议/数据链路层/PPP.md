# PPP

Point-to-Point Protocol

点对点协议

目前使用最广泛的数据链路层协议，用于点对点链路。主要用于用户计算机与ISP（互联网服务提供商）进行通信。

当用户拨号接入ISP时，路由器的调制解调器对拨号做出确认，并建立一条物理连接（底层up）。PC机向路由器发送一系列的LCP分组（封装成多个PPP帧）。这些分组及其响应选择一些PPP参数，和进行网络层配置（此前如有PAP或CHAP验证先要通过验证），NCP给新接入的PC机分配一个临时的IP地址，使PC机成为因特网上的一个主机。

PPP协议的特点：
- 简单，不需要纠错，不需要序号，不需要流量控制，这是首要需求。
- 封装成帧，特殊字符作为帧定界符，标志一个帧的开始和结束。
- 透明性，能正确处理与定界符一样的字符。
- 在同一条物理链路上同时支持多种网络层协议。
- 能在多种类型链路上运行。
- 对收到的帧进行差错检测，并立即丢弃有差错的帧。
- 自动检测链路工作状态。
- 设置最大传送单元（MTU），若上层协议分组长度超过MTU，则丢弃这样的帧，并报告出错。
- 提供机制，使通信的两个网络层实体能通过协商知道或配置彼此的网络层地址。
- 提供方法协商使用数据压缩算法。

PPP协议不提供的功能：
- 纠错：只进行检错。PPP是不可靠传输协议。
- 流量控制
- 序号
- 多点线路，即一个主站轮流和链路上的多个从站进行通信，PPP只支持点对点链路通信。
- 半双工或单工，PPP只支持全双工链路。

## 帧格式

<table>
    <tr>
        <th>字节</th>
        <th>1</th>
        <th>1</th>
        <th>1</th>
        <th>2</th>
        <th>可变</th>
        <th>2</th>
        <th>1</th>
    </tr>
    <tr>
        <th>字段</th>
        <td>F标志<br/>0x7E</td>
        <td>地址<br/>0xFF</td>
        <td>控制<br/>0x03</td>
        <td>协议</td>
        <td>信息</td>
        <td>FCS</td>
        <td>F标志<br/>0x7E</td>
    </tr>
</table>

##### 协议
- 0x0021 IP数据报
- 0xC021 LCP数据
- 0x8021 网络控制数据

##### 信息

###### 字节填充

- 信息字段中的每一个0x7E转变为0x7D5E
- 信息字段中的0x7D转变为0x7D5D
- 信息字段中的ASCII码控制字符（小于0x20）前加入0x7D，并改变字符编码

###### 零比特填充

发送端扫描信息字段，每5个连续的1后面填充1个0。

##### FCS
CRC帧检验序列
