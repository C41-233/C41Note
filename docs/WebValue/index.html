<html>

<head>
<title>WebValue</title>
<meta charset="utf-8"/>
<script src="../common.js"></script>
<style>
	.value-style{
		max-height: 160px;
		overflow-y: auto; 
		word-break: break-all;
		overflow-x: hidden;
	}
</style>
</head>

<body>
<main>
	<template>
		<div class="container">
			<el-table :data="Table">
				<el-table-column label="name">
					<template slot-scope="scope">{{scope.row.name}}</template>
				</el-table-column>
				<el-table-column label="type">
					<template slot-scope="scope">
						{{Typeof(scope.row.value)}}
					</template>
				</el-table-column>
				<el-table-column label="value">
					<div slot-scope="scope" class="value-style">
						<template v-if="scope.row.value === undefined">
							undefined
						</template>
						<template v-else-if="scope.row.value === null">
							null
						</template>
						<template v-else-if="scope.row.value.constructor === Object">
							Object
						</template>
						<template v-else-if="typeof(scope.row.value) === 'function'">
							Function
						</template>
						<template v-else>
							{{scope.row.value}}
						</template>
					</div>
				</el-table-column>
				<el-table-column label="enumerable" width="120">
					<template slot-scope="scope">{{scope.row.enumerable}}</template>
				</el-table-column>
				<el-table-column label="writable" width="120">
					<template slot-scope="scope">{{scope.row.writable}}</template>
				</el-table-column>
				<el-table-column label="configurable" width="120">
					<template slot-scope="scope">{{scope.row.configurable}}</template>
				</el-table-column>
				<el-table-column label="setter" width="120">
					<template slot-scope="scope">{{scope.row.set}}</template>
				</el-table-column>
			</el-table>
		</div>
	</template>
</main>

<script>
function compare(x, y){
	if(x > y){
		return 1;
	}
	if(x < y){
		return -1;
	}
	return 0;
}

$(function (){
	let app = new Vue({
		el: "main",
		data(){
			return {
				Table: []
			}
		},
		created(){
			this.Set(window);
		},
		methods: {
			Set(obj){
				let table = [];
				for(let key in obj){
					if(key === "$" || key === "Common" || key === "Vue"){
						continue;
					}
					let descriptor = Object.getOwnPropertyDescriptor(obj, key);
					let blob = {
						name: key,
						value: obj[key],
						enumerable: false,
						writable: false,
						configurable: false,
						set: false
					};
					if(descriptor){
						blob.enumerable = !!descriptor.enumerable;
						blob.writable = !!descriptor.writable;
						blob.configurable = !!descriptor.configurable;
						blob.set = !!descriptor.set;
					}
					table.push(blob);
				}
				table.sort((x, y) => compare(x.name, y.name));
				this.Table = table;
			},
			Typeof(value){
				let type = typeof(value);
				if(value === null){
					return "null";
				}
				if(type === "object"){
					return value.constructor.name;
				}
				return type;
			}
		}
	});
});	
</script>
</body>

</html>