# 64 Bit-Mode SMD

64 Bit指令是在IA32指令基础上扩展而来的，最多占用15字节。

<table>
	<tr>
	    <td>0,1,2,3,4</td>
	    <td>0,1</td>
	    <td>1,2</td>
	    <td>0,1</td>
	    <td>0,1</td>
	    <td>0,1,2,4,8</td>
	    <td>0,1,2,4,8</td>
    </tr>
    <tr>
        <td>Legacy Prefixes</td>
        <td>REX Prefix</td>
        <td>Opcode</td>
	    <td>ModeR/M</td>
	    <td>SIB</td>
	    <td>Displacement</td>
	    <td>Immediate</td>
    </tr>
    <tr>
        <td>前缀</td>
        <td>REX前缀</td>
        <td>操作码</td>
	    <td>内存/寄存器</td>
	    <td>索引寻址</td>
	    <td>偏移</td>
	    <td>立即数</td>
    </tr>
</table>

## REX prefix

占用2个字节，但是高4位固定为0100。

| Bit | 定义 |
|---|---|
| [7:4] | 0100 |
| [3] | W，0表示操作数位宽由CS.D决定；1表示64位操作数 |
| [2] | R，ModR/M.Reg扩展 |
| [1] | X，SIB.Index扩展 |
| [0] | B，ModR/M.R/M、SIB.Base扩展 |