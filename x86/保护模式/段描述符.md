# 段描述符和段选择子

## 段描述符
段描述符，共64位，提供段式存储基址。

保护模式寻址由段基址+段内偏移组成。段界限指段最大偏移，即段长减1。

### 标志位
| 位 | 描述 |
|---|---|
| [63] | 高8位段基址 |
| [55] | （G）段界限粒度。G=0表示字节，G=1表示4KB |
| [54] | D/B |
| [53] | 0 |
| [52] | （AVL）保留位，可以被系统软件使用 |
| [51] | 高4位段界限 |
| [47] | （P）存在位，P=1表示段在内存中，P=0表示段不在内存中 |
| [46] | （DPL）特权级，从高到低依次为0、1、2、3 |
| [44] | （S）S=1表示数据段/代码段描述符，S=0表示系统段/门描述符 |
| [43] | （TYPE）描述符类型 |
| [39] | 低24位段基址 |
| [15] | 低16位段界限 |

### 描述符类型
| | 数据段/代码段描述符 | 系统段/门描述符 |
|---|---|---|
| 0 | 只读 | 未定义 |
| 1 | 只读，已访问 | 可用286TSS |
| 2 | 读写 | LDT |
| 3 | 读写，已访问 | 忙的286TSS |
| 4 | 只读，向下扩展 | 286调用门 |
| 5 | 只读，向下扩展，已访问 | 任务门 |
| 6 | 读写，向下扩展 | 286中断门 |
| 7 | 读写，向下扩展，已访问 | 286陷阱门 |
| 8 | 只执行 | 未定义 |
| 9 | 只执行，已访问 | 可用386TSS |
| A | 执行/读 | 未定义 |
| B | 执行/读，已访问 | 忙的386TSS |
| C | 只执行，一致码段 | 386调用门 |
| D | 只执行，一致码段，已访问 | 未定义 |
| E | 执行/读，一致码段 | 386中断门 |
| F | 执行/读，一致码段，已访问 | 386陷阱门 |

### D/B位
在可执行代码段描述符中，1表示默认情况下指令使用32位地址和32位、8位操作数；0表示默认情况下使用16位地址和16位、8位操作数。

在向下扩展数据段描述符中，1表示段的上部界限为4GB；0表示段的上部界限位64KB。

在堆栈段描述符中，1表示隐式堆栈访问指令使用32位堆栈指针寄存器esp；0表示隐式堆栈访问指令使用16位堆栈指针寄存器sp。

## 段选择子

保护模式段地址，占16位，用于选择指定段描述符。

### 标志位
| 位 | 描述 |
|---|---|
| [15] | 描述符索引，即描述符表序号（从0开始编号） |
| [2] | （TI）1表示局部描述符表LDT读取，0表示从全局描述符表GDT读取 |
| [1] | （RPL）访问特权级，从高到低依次为0、1、2、3 |